if(grepl("r_ot", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"odw_t"
}else{
druga_zmienna<-"odw_t"
}
}
if(grepl("r_s", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"sigma"
}else{
druga_zmienna<-"sigma"
}
}
if(grepl("r_S0", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"S_0"
}else{
druga_zmienna<-"S_0"
}
}
if(grepl("r_r", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"r"
}else{
druga_zmienna<-"r"
}
}
if(grepl("r_K", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"K"
}else{
druga_zmienna<-"K"
}
}
if(grepl("r_T", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"T"
}else{
druga_zmienna<-"T"
}
}
czy_jest_r<-FALSE
if(pierwsza_zmienna=="r"){
czy_jest_r<-TRUE
}
if(druga_zmienna=="r"){
czy_jest_r<-TRUE
}
subset(dane,dane$wersja=="put") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+facet_wrap(~opcja)+
labs(title="Cena opcji put z podziałem",
subtitle = "na opcje amerykanskie i europejskie")
substr(my_list_nazwy[[i]], 1, 1) <- "p"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
if(czy_jest_r){
dane_mer <-merge(subset(dane,dane$wersja == "call"&dane$opcja == "a"),
subset(dane,dane$wersja == "call"&dane$opcja == "e"),
by.x = c("sigma","S_0","K","T","r","odw_t","t","wersja"),
by.y =c("sigma","S_0","K","T","r","odw_t","t","wersja"))
dane_mer$roznica <- dane_mer$cena_opcji.x-dane_mer$cena_opcji.y
plot1<-subset(dane,dane$wersja=="call"&dane$opcja == "e") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji europejskiej call")
plot2<-subset(dane_mer) %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = roznica))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
labs(title="Róznica w cenie opcji call",
subtitle = "między opcją amerykanską i europejską")+
scale_fill_gradient(low = "beige", high = "forestgreen")
grid.arrange(plot1, plot2, ncol = 2)
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
}else{
subset(dane,dane$wersja=="call"&dane$opcja=="a") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji call",
subtitle = "równa dla opcji amerykanskiej i europejskiej")
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
}
}
for (i in seq_along(my_list)) {
dane<-my_list[[i]]
pierwsza_zmienna<-NULL
druga_zmienna<-NULL
if(grepl("r_ot", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"odw_t"
}else{
druga_zmienna<-"odw_t"
}
}
if(grepl("r_s", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"sigma"
}else{
druga_zmienna<-"sigma"
}
}
if(grepl("r_S0", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"S_0"
}else{
druga_zmienna<-"S_0"
}
}
if(grepl("r_r", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"r"
}else{
druga_zmienna<-"r"
}
}
if(grepl("r_K", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"K"
}else{
druga_zmienna<-"K"
}
}
if(grepl("r_T", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"T"
}else{
druga_zmienna<-"T"
}
}
czy_jest_r<-FALSE
if(pierwsza_zmienna=="r"){
czy_jest_r<-TRUE
}
if(druga_zmienna=="r"){
czy_jest_r<-TRUE
}
subset(dane,dane$wersja=="put") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+facet_wrap(~opcja)+
labs(title="Cena opcji put z podziałem",
subtitle = "na opcje amerykanskie i europejskie")
substr(my_list_nazwy[[i]], 1, 1) <- "p"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
if(czy_jest_r){
dane_mer <-merge(subset(dane,dane$wersja == "call"&dane$opcja == "a"),
subset(dane,dane$wersja == "call"&dane$opcja == "e"),
by.x = c("sigma","S_0","K","T","r","odw_t","t","wersja"),
by.y =c("sigma","S_0","K","T","r","odw_t","t","wersja"))
dane_mer$roznica <- dane_mer$cena_opcji.x-dane_mer$cena_opcji.y
plot1<-subset(dane,dane$wersja=="call"&dane$opcja == "e") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji europejskiej call")
plot2<-subset(dane_mer) %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = roznica))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
labs(title="Róznica w cenie opcji call",
subtitle = "między opcją amerykanską i europejską")+
scale_fill_gradient(low = "beige", high = "forestgreen")
g <- arrangeGrob(plot1, plot2, ncol = 2) #generates g
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),g,path  = "./wykresy")
}else{
subset(dane,dane$wersja=="call"&dane$opcja=="a") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji call",
subtitle = "równa dla opcji amerykanskiej i europejskiej")
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
}
}
if(czy_jest_r){
dane_mer <-merge(subset(dane,dane$wersja == "call"&dane$opcja == "a"),
subset(dane,dane$wersja == "call"&dane$opcja == "e"),
by.x = c("sigma","S_0","K","T","r","odw_t","t","wersja"),
by.y =c("sigma","S_0","K","T","r","odw_t","t","wersja"))
dane_mer$roznica <- dane_mer$cena_opcji.x-dane_mer$cena_opcji.y
plot1<-subset(dane,dane$wersja=="call"&dane$opcja == "e") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji",
subtitle = " europejskiej call")
plot2<-subset(dane_mer) %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = roznica))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
labs(title="Róznica w cenie opcji call",
subtitle = "między opcją amerykanską i europejską")+
scale_fill_gradient(low = "beige", high = "forestgreen")
g <- arrangeGrob(plot1, plot2, ncol = 2) #generates g
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),g,path  = "./wykresy",width = 12)
}else{
subset(dane,dane$wersja=="call"&dane$opcja=="a") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji call",
subtitle = "równa dla opcji amerykanskiej i europejskiej")
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
}
for (i in seq_along(my_list)) {
dane<-my_list[[i]]
pierwsza_zmienna<-NULL
druga_zmienna<-NULL
if(grepl("r_ot", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"odw_t"
}else{
druga_zmienna<-"odw_t"
}
}
if(grepl("r_s", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"sigma"
}else{
druga_zmienna<-"sigma"
}
}
if(grepl("r_S0", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"S_0"
}else{
druga_zmienna<-"S_0"
}
}
if(grepl("r_r", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"r"
}else{
druga_zmienna<-"r"
}
}
if(grepl("r_K", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"K"
}else{
druga_zmienna<-"K"
}
}
if(grepl("r_T", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"T"
}else{
druga_zmienna<-"T"
}
}
czy_jest_r<-FALSE
if(pierwsza_zmienna=="r"){
czy_jest_r<-TRUE
}
if(druga_zmienna=="r"){
czy_jest_r<-TRUE
}
subset(dane,dane$wersja=="put") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+facet_wrap(~opcja)+
labs(title="Cena opcji put z podziałem",
subtitle = "na opcje amerykanskie i europejskie")
substr(my_list_nazwy[[i]], 1, 1) <- "p"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
if(czy_jest_r){
dane_mer <-merge(subset(dane,dane$wersja == "call"&dane$opcja == "a"),
subset(dane,dane$wersja == "call"&dane$opcja == "e"),
by.x = c("sigma","S_0","K","T","r","odw_t","t","wersja"),
by.y =c("sigma","S_0","K","T","r","odw_t","t","wersja"))
dane_mer$roznica <- dane_mer$cena_opcji.x-dane_mer$cena_opcji.y
plot1<-subset(dane,dane$wersja=="call"&dane$opcja == "e") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji",
subtitle = " europejskiej call")
plot2<-subset(dane_mer) %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = roznica))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
labs(title="Róznica w cenie opcji call",
subtitle = "między opcją amerykanską i europejską")+
scale_fill_gradient(low = "beige", high = "forestgreen")
g <- arrangeGrob(plot1, plot2, ncol = 2) #generates g
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),g,path  = "./wykresy",width = 12)
}else{
subset(dane,dane$wersja=="call"&dane$opcja=="a") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji call",
subtitle = "równa dla opcji amerykanskiej i europejskiej")
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
}
}
dane_mer
for (i in seq_along(my_list)) {
dane<-my_list[[i]]
pierwsza_zmienna<-NULL
druga_zmienna<-NULL
if(grepl("r_ot", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"odw_t"
}else{
druga_zmienna<-"odw_t"
}
}
if(grepl("r_s", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"sigma"
}else{
druga_zmienna<-"sigma"
}
}
if(grepl("r_S0", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"S_0"
}else{
druga_zmienna<-"S_0"
}
}
if(grepl("r_r", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"r"
}else{
druga_zmienna<-"r"
}
}
if(grepl("r_K", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"K"
}else{
druga_zmienna<-"K"
}
}
if(grepl("r_T", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"T"
}else{
druga_zmienna<-"T"
}
}
czy_jest_r<-FALSE
if(pierwsza_zmienna=="r"){
czy_jest_r<-TRUE
}
if(druga_zmienna=="r"){
czy_jest_r<-TRUE
}
subset(dane,dane$wersja=="put") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+facet_wrap(~opcja)+
labs(title="Cena opcji put z podziałem",
subtitle = "na opcje amerykanskie i europejskie")
substr(my_list_nazwy[[i]], 1, 1) <- "p"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
if(czy_jest_r){
dane_mer <-merge(subset(dane,dane$wersja == "call"&dane$opcja == "a"),
subset(dane,dane$wersja == "call"&dane$opcja == "e"),
by.x = c("sigma","S_0","K","T","r","odw_t","t","wersja"),
by.y =c("sigma","S_0","K","T","r","odw_t","t","wersja"))
dane_mer$roznica <- (dane_mer$cena_opcji.x-dane_mer$cena_opcji.y)/dane_mer$cena_opcji.y
plot1<-subset(dane,dane$wersja=="call"&dane$opcja == "e") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji",
subtitle = " europejskiej call")
plot2<-subset(dane_mer) %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = roznica))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
labs(title="Róznica wzgledna w cenie opcji call",
subtitle = "między opcją amerykanską i europejską")+
scale_fill_gradient(low = "beige", high = "forestgreen")
g <- arrangeGrob(plot1, plot2, ncol = 2) #generates g
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),g,path  = "./wykresy",width = 12)
}else{
subset(dane,dane$wersja=="call"&dane$opcja=="a") %>%
ggplot(aes(x=  .data[[pierwsza_zmienna]],y = .data[[druga_zmienna]],fill = cena_opcji))+
geom_tile()+
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "bottom",
panel.grid = element_blank(),
panel.background = element_rect(fill = "white"),
plot.background = element_rect(fill = "white"))+
scale_fill_viridis_c()+
labs(title="Cena opcji call",
subtitle = "równa dla opcji amerykanskiej i europejskiej")
substr(my_list_nazwy[[i]], 1, 1) <- "c"
ggsave(paste0(my_list_nazwy[[i]],".pdf"),path  = "./wykresy")
}
}
