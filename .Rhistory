rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
rchisq(1,4)
library(ggplot2)
zad4_1<-data.frame(v1 = v1,v2 = v2)
##zad4
N <- 1000
dis<-function(c,t){
return(c*exp(-0.05*t))
}
v1<-rexp(N,5)
v2<-runif(N,0,20)
zad4_1<-data.frame(v1 = v1,v2 = v2)
ggplot(zad4_1,aes(x=v1,y=v2))
ggplot(zad4_1,aes(x=v1,y=v2))+geom_point()
zad4_1
collapse::mrtl(zad4_1)
install.packages("collapse")
disv<-Vectorize(dis)
disv(v1,v2)
V<-c(1:N)
for(i in 1:N){
V[i]<-dis(v1[i],v2[i])
}
V
sum(disv(v1,v2)-V)
policz_raz_calosc<-function(N = 1000){
v1<-rexp(N,5)
v2<-runif(N,0,20)
return(sum(disv(v1,v2)))
}
hist(replicate(100,policz_raz_calosc()))
hist(replicate(100,policz_raz_calosc()))
'''
adsvkd
'''
1000*1/5*(1-exp(-1))
abline(v = 1000*1/5*(1-exp(-1)))
#zad 5
N <- 1000
V <- seq(-N,N,1)
source("C:/Users/jaako/Desktop/studia/wdmf/l1/wdmf_l1.R", echo=TRUE)
V <- seq(-N,N,1)
V
max(V)
sample(V,length(V),replace = F)
Vs<-sample(V,length(V),replace = F)
cumsum(Vs)
Vs<cumsum(Vs)
Vs
Vs>=cumsum(Vs)
Vs[Vs>=cumsum(Vs)]
length(Vs[Vs>=cumsum(Vs)])
N <- 1000
V <- seq(-N,N,1)
Vs<-sample(V,length(V),replace = F)
length(Vs[Vs>=cumsum(Vs)])
N <- 1000
V <- seq(-N,N,1)
Vs<-sample(V,length(V),replace = F)
length(Vs[Vs>=cumsum(Vs)])
N <- 1000
V <- seq(-N,N,1)
Vs<-sample(V,length(V),replace = F)
length(Vs[Vs>=cumsum(Vs)])
N <- 1000
V <- seq(-N,N,1)
Vs<-sample(V,length(V),replace = F)
length(Vs[Vs>=cumsum(Vs)])
N <- 1000
V <- seq(-N,N,1)
Vs<-sample(V,length(V),replace = F)
length(Vs[Vs>=cumsum(Vs)])
N <- 1000
V <- seq(-N,N,1)
Vs<-sample(V,length(V),replace = F)
length(Vs[Vs>=cumsum(Vs)])
length(Vs[Vs>=cummax(Vs)])
data.frame(n = 1:length(Vs),value = Vs,type = "perm")
rbind(
data.frame(n = 1:length(Vs),value = Vs,type = "perm"),
data.frame(n = 1:length(Vs),value = cumsum(Vs),type = "cumsum"),
data.frame(n = 1:length(Vs),value = cummax(Vs),type = "cummax")
)
zad5<-rbind(
data.frame(n = 1:length(Vs),value = Vs,type = "perm"),
data.frame(n = 1:length(Vs),value = cumsum(Vs),type = "cumsum"),
data.frame(n = 1:length(Vs),value = cummax(Vs),type = "cummax")
)
ggplot(zad5,aes(x = n,y = value,col = type))+geom_line()
zad5_2<-rbind(
data.frame(n = 1:length(Vs),value = Vs,type = "perm"),
data.frame(n = 1:length(Vs),value = cummax(Vs),type = "cummax")
)
ggplot(zad5_2,aes(x = n,y = value,col = type))+geom_line()
##zad6
n <- 500
m <- 252
matrix(rnorm(n*m,mean = mu,sd = sd),ncol = m)
##zad6
n <- 500
m <- 252
mu <- 0.2
sd <-0.3
matrix(rnorm(n*m,mean = mu,sd = sd),ncol = m)
mat<-matrix(rnorm(n*m,mean = mu,sd = sd),ncol = m)
apply(mat,2,cumsum)
M<-matrix(c(1,2,3,4),ncol = 2)
M
apply(M,2,cumsum)
apply(M,1,cumsum)
##zad6
n <- 500
m <- 252
mu <- 0.2
sd <-0.3
M<-matrix(c(1,2,3,4),ncol = 2)
M
apply(M,1,cumsum)
apply(M,1,sum)
apply(M,1,cummax)
apply(M,1,cumsum)
M
t(apply(M,1,cumsum))
M<-matrix(c(1,2,3,4),ncol = 2)
M
t(apply(M,2,cumsum))
t(apply(M,2,cumsum))
c(t(apply(M,2,cumsum)))
sapply(1:m,function(i){replicate(n,i)})
c(sapply(1:m,function(i){replicate(n,i)}))
replicate(m,1:n)
c(replicate(m,1:n))
t(replicate(m,1:n))
c(t(replicate(m,1:n)))
data.frame(n = c(t(replicate(m,1:n))),value = c(t(apply(M,2,cumsum))),
version = c(sapply(1:m,function(i){replicate(n,i)})))
data.frame(n = c(t(replicate(m,1:n))),value = c(t(apply(mat,2,cumsum))),
version = c(sapply(1:m,function(i){replicate(n,i)})))
data.frame(n = c(replicate(m,1:n)),value = c(t(apply(mat,2,cumsum))),
version = c(sapply(1:m,function(i){replicate(n,i)})))
zad6<-data.frame(n = c(replicate(m,1:n)),value = c(t(apply(mat,2,cumsum))),
version = c(sapply(1:m,function(i){replicate(n,i)})))
ggplot(zad6,aes(x = n,y = value,col = version))+geom_line()
subset(zad6,zad6$version %%  50== 0)
ggplot(subset(zad6,zad6$version %%  50== 0),aes(x = n,y = value,col = version))+geom_line()
library(ggplot2)
library(dplyr)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
d_r_ot<-read.csv("./dane/dane_odwr_t_od_2_do_98_sigma_0.3_S_0_50_r_0.02_K_48_T_2_.csv",
header = T,sep = ",")
d_r_s<-read.csv("./dane/dane_odwr_t_12_sigma_od_0.05_do0.3_S_0_50_r_0.02_K_48_T_2_.csv",
header = T,sep = ",")
d_r_S0<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_od_30_do_79_r_0.02_K_48_T_2_.csv",
header = T,sep = ",")
d_r_r<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_50_r_od_-0.03_do_0.19000000000000003_K_48_T_2_.csv",
header = T,sep = ",")
d_r_K<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_50_r_0.02_K_od_30_do_79_T_2_.csv",
header = T,sep = ",")
d_r_T<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_50_r_0.02_K_48_T_od_1_do_99_.csv",
header = T,sep = ",")
subset(d_r_ot,d_r_ot$wersja=="put") %>%
ggplot(aes(x=  t,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji put dla roznych t",x="t",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("p_r_ot.pdf",path  = "./wykresy")
subset(d_r_ot,d_r_ot$wersja=="call") %>%
ggplot(aes(x=  t,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji call dla roznych t",x="t",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("c_r_ot.pdf",path  = "./wykresy")
#d_r_s
subset(d_r_s,d_r_s$wersja=="put") %>%
ggplot(aes(x=  sigma,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji put dla roznych sigma",x="sigma",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("p_r_s.pdf",path  = "./wykresy")
subset(d_r_s,d_r_s$wersja=="call") %>%
ggplot(aes(x=  sigma,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji call dla roznych sigma",x="sigma",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("c_r_s.pdf",path  = "./wykresy")
#d_r_S0
subset(d_r_S0,d_r_S0$wersja=="put") %>%
ggplot(aes(x=  S_0,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji put dla roznych S_0",x="S_0",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("p_r_S0.pdf",path  = "./wykresy")
subset(d_r_S0,d_r_S0$wersja=="call") %>%
ggplot(aes(x=  S_0,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji call dla roznych S_0",x="S_0",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("c_r_S0.pdf",path  = "./wykresy")
#d_r_r
subset(d_r_r,d_r_r$wersja=="put") %>%
ggplot(aes(x=  r,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji put dla roznych r",x="r",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("p_r_r.pdf",path  = "./wykresy")
subset(d_r_r,d_r_r$wersja=="call") %>%
ggplot(aes(x=  r,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji call dla roznych r",x="r",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("c_r_r.pdf",path  = "./wykresy")
#d_r_K
subset(d_r_K,d_r_K$wersja=="put") %>%
ggplot(aes(x=  K,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji put dla roznych K",x="K",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("p_r_K.pdf",path  = "./wykresy")
subset(d_r_K,d_r_K$wersja=="call") %>%
ggplot(aes(x=  K,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji call dla roznych K",x="K",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("c_r_K.pdf",path  = "./wykresy")
subset(d_r_T,d_r_T$wersja=="put") %>%
ggplot(aes(x=  T,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji put dla roznych T",x="T",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("p_r_T.pdf",path  = "./wykresy")
subset(d_r_T,d_r_T$wersja=="call") %>%
ggplot(aes(x=  T,y = cena_opcji,col = opcja))+geom_line()+
labs(title="Cena opcji call dla roznych T",x="T",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
ggsave("c_r_T.pdf",path  = "./wykresy")
d_r_ot_r_s<-read.csv("./dane/dane_odwr_t_od_2_do_98_sigma_od_0.05_do0.3_S_0_50_r_0.02_K_48_T_2_.csv",
header = T,sep = ",")
d_r_ot_r_S0<-read.csv("./dane/dane_odwr_t_od_2_do_98_sigma_0.3_S_0_od_30_do_79_r_0.02_K_48_T_2_.csv",
header = T,sep = ",")
d_r_ot_r_r<-read.csv("./dane/dane_odwr_t_od_2_do_98_sigma_0.3_S_0_50_r_od_-0.03_do_0.19000000000000003_K_48_T_2_.csv",
header = T,sep = ",")
d_r_ot_r_K<-read.csv("./dane/dane_odwr_t_od_2_do_98_sigma_0.3_S_0_50_r_0.02_K_od_30_do_79_T_2_.csv",
header = T,sep = ",")
d_r_ot_r_T<-read.csv("./dane/dane_odwr_t_od_2_do_98_sigma_0.3_S_0_50_r_0.02_K_48_T_od_1_do_99_.csv",
header = T,sep = ",")
d_r_s_r_S0<-read.csv("./dane/dane_odwr_t_12_sigma_od_0.05_do0.3_S_0_od_30_do_79_r_0.02_K_48_T_2_.csv",
header = T,sep = ",")
d_r_s_r_K<-read.csv("./dane/dane_odwr_t_12_sigma_od_0.05_do0.3_S_0_50_r_0.02_K_od_30_do_79_T_2_.csv",
header = T,sep = ",")
d_r_s_r_r<-read.csv("./dane/dane_odwr_t_12_sigma_od_0.05_do0.3_S_0_50_r_od_-0.03_do_0.19000000000000003_K_48_T_2_.csv",
header = T,sep = ",")
d_r_s_r_T<-read.csv("./dane/dane_odwr_t_12_sigma_od_0.05_do0.3_S_0_50_r_0.02_K_48_T_od_1_do_99_.csv",
header = T,sep = ",")
d_r_S0_r_K<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_od_30_do_79_r_0.02_K_od_30_do_79_T_2_.csv",
header = T,sep = ",")
d_r_S0_r_r<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_od_30_do_79_r_od_-0.03_do_0.19000000000000003_K_48_T_2_.csv",
header = T,sep = ",")
d_r_S0_r_T<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_od_30_do_79_r_0.02_K_48_T_od_1_do_99_.csv",
header = T,sep = ",")
d_r_r_r_K<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_50_r_od_-0.03_do_0.19000000000000003_K_od_30_do_79_T_2_.csv",
header = T,sep = ",")
d_r_r_r_T<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_50_r_od_-0.03_do_0.19000000000000003_K_48_T_od_1_do_99_.csv",
header = T,sep = ",")
d_r_K_r_T<-read.csv("./dane/dane_odwr_t_12_sigma_0.3_S_0_50_r_0.02_K_od_30_do_79_T_od_1_do_99_.csv",
header = T,sep = ",")
my_list<-list(d_r_ot_r_s, d_r_ot_r_S0, d_r_ot_r_r,d_r_ot_r_K,d_r_ot_r_T,
d_r_s_r_S0,d_r_s_r_K,d_r_s_r_r,d_r_s_r_T,
d_r_S0_r_K,d_r_S0_r_r,d_r_S0_r_T,
d_r_r_r_K,d_r_r_r_T,d_r_K_r_T)
my_list_nazwy<-list("d_r_ot_r_s", "d_r_ot_r_S0", "d_r_ot_r_r","d_r_ot_r_K","d_r_ot_r_T",
"d_r_s_r_S0","d_r_s_r_K","d_r_s_r_r","d_r_s_r_T",
"d_r_S0_r_K","d_r_S0_r_r","d_r_S0_r_T",
"d_r_r_r_K","d_r_r_r_T","d_r_K_r_T")
i<-7
dane<-my_list[[i]]
pierwsza_zmienna<-NULL
druga_zmienna<-NULL
if(grepl("r_ot", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"t"
}else{
druga_zmienna<-"t"
}
}
if(grepl("r_s", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"sigma"
}else{
druga_zmienna<-"sigma"
}
}
if(grepl("r_S0", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"S_0"
}else{
druga_zmienna<-"S_0"
}
}
if(grepl("r_r", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"r"
}else{
druga_zmienna<-"r"
}
}
if(grepl("r_K", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"K"
}else{
druga_zmienna<-"K"
}
}
if(grepl("r_T", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"T"
}else{
druga_zmienna<-"T"
}
}
dane
for (i in seq_along(my_list)) {
dane<-my_list[[i]]
pierwsza_zmienna<-NULL
druga_zmienna<-NULL
if(grepl("r_ot", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"t"
}else{
druga_zmienna<-"t"
}
}
if(grepl("r_s", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"sigma"
}else{
druga_zmienna<-"sigma"
}
}
if(grepl("r_S0", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"S_0"
}else{
druga_zmienna<-"S_0"
}
}
if(grepl("r_r", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"r"
}else{
druga_zmienna<-"r"
}
}
if(grepl("r_K", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"K"
}else{
druga_zmienna<-"K"
}
}
if(grepl("r_T", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"T"
}else{
druga_zmienna<-"T"
}
}
print(my_list_nazwy[[i]])
dane$t<-as.factor(dane$t)
dane$sigma<-as.factor(dane$sigma)
dane$K<-as.factor(dane$K)
dane$S_0<-as.factor(dane$S_0)
dane$T<-as.factor(dane$T)
dane$r<-as.factor(dane$r)
subset(dane,dane$wersja=="put"&dane$opcja=="a") %>%
ggplot(aes(x=  pierwsza_zmienna,y = druga_zmienna,fill = cena_opcji))+
geom_tile()+
labs(title="Cena opcji put dla roznych r",x="r",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
print(p)
}
for (i in seq_along(my_list)) {
dane<-my_list[[i]]
pierwsza_zmienna<-NULL
druga_zmienna<-NULL
if(grepl("r_ot", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"t"
}else{
druga_zmienna<-"t"
}
}
if(grepl("r_s", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"sigma"
}else{
druga_zmienna<-"sigma"
}
}
if(grepl("r_S0", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"S_0"
}else{
druga_zmienna<-"S_0"
}
}
if(grepl("r_r", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"r"
}else{
druga_zmienna<-"r"
}
}
if(grepl("r_K", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"K"
}else{
druga_zmienna<-"K"
}
}
if(grepl("r_T", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"T"
}else{
druga_zmienna<-"T"
}
}
print(my_list_nazwy[[i]])
dane$t<-as.factor(dane$t)
dane$sigma<-as.factor(dane$sigma)
dane$K<-as.factor(dane$K)
dane$S_0<-as.factor(dane$S_0)
dane$T<-as.factor(dane$T)
dane$r<-as.factor(dane$r)
p<-subset(dane,dane$wersja=="put"&dane$opcja=="a") %>%
ggplot(aes(x=  pierwsza_zmienna,y = druga_zmienna,fill = cena_opcji))+
geom_tile()+
labs(title="Cena opcji put dla roznych r",x="r",y="cena opcji")+
theme(plot.title = element_text(hjust = 0.5))
print(p)
}
for (i in seq_along(my_list)) {
dane<-my_list[[i]]
pierwsza_zmienna<-NULL
druga_zmienna<-NULL
if(grepl("r_ot", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"t"
}else{
druga_zmienna<-"t"
}
}
if(grepl("r_s", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"sigma"
}else{
druga_zmienna<-"sigma"
}
}
if(grepl("r_S0", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"S_0"
}else{
druga_zmienna<-"S_0"
}
}
if(grepl("r_r", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"r"
}else{
druga_zmienna<-"r"
}
}
if(grepl("r_K", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"K"
}else{
druga_zmienna<-"K"
}
}
if(grepl("r_T", my_list_nazwy[[i]])){
if(is.null(pierwsza_zmienna)){
pierwsza_zmienna<-"T"
}else{
druga_zmienna<-"T"
}
}
print(my_list_nazwy[[i]])
dane$t<-as.factor(dane$t)
dane$sigma<-as.factor(dane$sigma)
dane$K<-as.factor(dane$K)
dane$S_0<-as.factor(dane$S_0)
dane$T<-as.factor(dane$T)
dane$r<-as.factor(dane$r)
p<-subset(dane,dane$wersja=="put"&dane$opcja=="a") %>%
ggplot(aes(x=  pierwsza_zmienna,y = druga_zmienna,fill = cena_opcji))+
geom_tile()+
labs(title="Cena opcji put dla roznych r")+
theme(plot.title = element_text(hjust = 0.5))
print(p)
}
subset(dane,dane$wersja=="put"&dane$opcja=="a") %>%
ggplot(aes(x=  K,y = sigma,fill = cena_opcji))+
geom_tile()+
labs(title="Cena opcji put dla roznych r")+
theme(plot.title = element_text(hjust = 0.5))
